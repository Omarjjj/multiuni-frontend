/* Styles for ChatPage.tsx */

/* Add base styles for chat page layout, messages, etc. */

/* Placeholder for ChatPage specific styles */

.chat-page {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background-color: var(--chat-page-bg, #f7f3ef);
  color: var(--chat-text-primary, #333);
  overflow: hidden;
  font-family: 'Tajawal', sans-serif;
  direction: rtl;
}

.chat-container {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  max-width: 800px; /* Max width of the chat content */
  width: 100%;
  margin: 0 auto; /* Center the chat container */
  box-shadow: 0 0 20px rgba(0,0,0,0.05);
  background-color: var(--chat-container-bg, #fff);
  /* overflow: hidden; */ /* Temporarily remove to see if it fixes bubble clipping */
  border-left: 1px solid var(--border, #e0e0e0);
  border-right: 1px solid var(--border, #e0e0e0);
}

.chat-header {
  display: flex;
  align-items: center;
  padding: 0.75rem 1rem;
  background-color: var(--chat-header-bg, #f8f9fa);
  border-bottom: 1px solid var(--border, #e0e0e0);
  min-height: 60px;
}

.back-button, .chat-utils-button {
  background: none;
  border: none;
  color: var(--primary);
  cursor: pointer;
  padding: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background-color 0.2s ease;
}

.back-button:hover, .chat-utils-button:hover {
  background-color: rgba(0,0,0,0.05);
}

.header-logo {
  width: 36px;
  height: 36px;
  object-fit: contain;
  margin-left: 0.75rem; /* RTL: logo on right of title, so margin-left */
  margin-right: 0.5rem;
}

.chat-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--foreground);
  margin: 0;
  flex-grow: 1;
  text-align: right;
}

.chat-messages {
  flex-grow: 1;
  overflow-y: auto;
  padding: 1rem 1.25rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.chat-bubble {
  display: flex;
  margin-bottom: 0.5rem;
  max-width: 80%;
  align-items: flex-end; /* Align avatar with bottom of bubble */
}

.chat-bubble-user {
  align-self: flex-start; /* User on the left in RTL */
  margin-left: auto; /* Push to the right */
  flex-direction: row-reverse; /* Avatar on the right of text, if shown */
}

.chat-bubble-assistant {
  align-self: flex-end; /* Assistant on the right in RTL */
  margin-right: auto; /* Push to the left */
  flex-direction: row; /* Avatar on the left of text */
}

.chat-bubble-avatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  overflow: hidden;
  margin: 0 0.5rem;
  flex-shrink: 0;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  background-color: var(--secondary, #e9ecef);
  display: flex;
  align-items: center;
  justify-content: center;
}

.chat-bubble-user .chat-bubble-avatar {
  display: none; /* Usually no avatar for user */
}

.message-avatar-logo {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.chat-bubble-content {
  padding: 0.8rem 1.1rem;
  border-radius: 18px;
  font-size: 0.95rem;
  line-height: 1.6;
  word-wrap: break-word;
  box-shadow: var(--chat-bubble-shadow, 0 2px 5px rgba(0,0,0,0.08));
  position: relative; /* For timestamp potentially */
}

.chat-bubble-user .chat-bubble-content {
  background-color: var(--user-bubble-bg, var(--primary));
  color: var(--user-bubble-text, var(--primary-foreground));
  border-radius: 18px 18px 2px 18px; /* User bubble shape for RTL */
}

.chat-bubble-assistant .chat-bubble-content {
  background-color: #faf7f2; /* Vintage off-white color */
  color: #4a4a4a; /* Softer text color */
  border-radius: 18px 18px 18px 2px;
  border: 1px solid #e6e0d8; /* Subtle vintage border */
  box-shadow: 0 2px 8px rgba(185, 173, 157, 0.15); /* Soft vintage shadow */
}

.message-timestamp {
  display: block;
  font-size: 0.75rem;
  color: var(--timestamp-color, #888);
  margin-top: 0.3rem;
  text-align: left; /* Timestamp usually on the left under the bubble (in RTL flow) */
}

.chat-bubble-user .message-timestamp {
  text-align: right; /* User timestamp on the right */
  color: var(--user-timestamp-color, var(--primary-foreground-muted));
}

.user-message-text {
  /* Basic text styling if not using markdown for user */
}

/* Loading indicator styles */
.loading-indicator-bubble .chat-bubble-content {
  background-color: #faf7f2; /* Match the vintage style */
  padding: 0.5rem 0.8rem;
  border: 1px solid #e6e0d8;
  box-shadow: 0 2px 8px rgba(185, 173, 157, 0.15);
}

.loading-animation-container {
  display: flex;
  align-items: center;
}

.ai-loading-icon {
  display: flex;
  align-items: center;
  margin-left: 8px; /* RTL: dots on left of text */
}

.ai-loading-circle {
  width: 6px;
  height: 6px;
  background-color: var(--primary);
  border-radius: 50%;
  margin: 0 2px;
  /* animation: aiLoading 1.2s infinite ease-in-out; */ /* Animation removed */
}

.ai-loading-circle:nth-child(1) { /* animation-delay: -0.24s; */ }
.ai-loading-circle:nth-child(2) { /* animation-delay: -0.12s; */ }
.ai-loading-circle:nth-child(3) { /* animation-delay: 0s; */ }

/* @keyframes aiLoading {
  0%, 80%, 100% { transform: scale(0.5); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
} */ /* Keyframes removed */

.loading-text-container {
  display: flex;
  flex-direction: column;
  align-items: flex-start; /* RTL: text starts from right */
}

.loading-text-primary {
  font-size: 0.9rem;
  font-weight: 500;
  color: var(--assistant-bubble-text);
  margin: 0;
}

.loading-text-secondary {
  font-size: 0.8rem;
  color: var(--muted-foreground);
  margin: 0;
}

.loading-dots::after {
  content: '.';
  animation: dots 1s steps(5, end) infinite;
}

@keyframes dots {
  0%, 20% { color: rgba(0,0,0,0); text-shadow: .25em 0 0 rgba(0,0,0,0), .5em 0 0 rgba(0,0,0,0); }
  40% { color: var(--muted-foreground); text-shadow: .25em 0 0 rgba(0,0,0,0), .5em 0 0 rgba(0,0,0,0); }
  60% { text-shadow: .25em 0 0 var(--muted-foreground), .5em 0 0 rgba(0,0,0,0); }
  80%, 100% { text-shadow: .25em 0 0 var(--muted-foreground), .5em 0 0 var(--muted-foreground); }
}

/* Markdown content styles (can be enhanced) */
.markdown-content {
  font-size: 0.95rem;
  line-height: 1.6;
}

.markdown-content p {
  margin-bottom: 0.5rem;
}

.markdown-content ul, .markdown-content ol {
  padding-right: 1.5rem; /* RTL: padding on the right for lists */
  margin-bottom: 0.5rem;
}

.markdown-content strong {
  font-weight: 600;
}

.markdown-content table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
  margin-bottom: 1rem;
  font-size: 0.9em;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  border-radius: 6px;
  overflow: hidden;
}
.markdown-content th,
.markdown-content td {
  border: 1px solid var(--border, #ddd);
  padding: 8px 12px;
  text-align: right;
}
.markdown-content th {
  background-color: var(--table-header-bg, #f0f4f8);
  color: var(--table-header-text, #333);
  font-weight: bold;
  border-bottom: 2px solid var(--primary);
}
.markdown-content tbody tr:nth-child(even) {
  background-color: var(--table-row-even-bg, #f9f9f9);
}
.markdown-content tbody tr:hover {
  background-color: var(--table-row-hover-bg, #eef4ff);
}

.chat-input-wrapper {
  padding: 0.75rem 1rem;
  border-top: 1px solid var(--border, #e0e0e0);
  background-color: var(--chat-input-bg, #f8f9fa);
}

/* Backend status (optional, for debugging) */
.backend-status-error {
  padding: 0.5rem;
  background-color: #ffebee;
  color: #c62828;
  text-align: center;
  font-size: 0.85rem;
  border-radius: 4px;
  margin: 0.5rem;
}

/* Custom scrollbar for chat messages */
.chat-messages::-webkit-scrollbar {
  width: 6px;
}

.chat-messages::-webkit-scrollbar-track {
  background: transparent; 
}

.chat-messages::-webkit-scrollbar-thumb {
  background-color: var(--primary-scrollbar, var(--primary));
  border-radius: 6px;
}

.chat-messages::-webkit-scrollbar-thumb:hover {
  background-color: hsl(var(--primary-h), var(--primary-s), calc(var(--primary-l) * 0.8));
}

/* Help text bubble on ChatPage (for UtilityIcon) */
.utility-icon-wrapper {
  position: relative;
}
.help-text-bubble {
  position: absolute;
  top: calc(100% + -45px);
  right: -65px;
  background-color: var(--primary);
  color: var(--primary-foreground);
  padding: 8px 12px;
  border-radius: 8px;
  font-size: 0.8rem;
  font-weight: 500;
  max-width: 160px;
  text-align: right;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  opacity: 0;
  pointer-events: none;
  background: var(--primary);
}

.help-text-bubble::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 60%;
  transform: translateX(-50%);
  border-width: 6px;
  border-style: solid;
  border-color: var(--primary) transparent transparent transparent;
}